import{a as re,$ as F,d as $e,j as h}from"./index-b6d4726d.js";import{r as e,b as me}from"./index-ad8e37b4.js";import{_ as g}from"./extends-98964cd2.js";import{$ as C}from"./index-1b3f171e.js";import{$ as we}from"./index-f730bee5.js";import{$ as Te}from"./index-25542281.js";import{a as ve,b as Ee}from"./index-dc32c729.js";import{$ as xe}from"./index-fc7623f3.js";import{$ as ye}from"./index-c83839f6.js";import{$ as U}from"./index-a29557c5.js";import{$ as Ce}from"./index-cb864916.js";import{$ as he}from"./index-de5e260d.js";import{a as se}from"./index-f617d252.js";import"./_commonjsHelpers-725317a4.js";const ae="ToastProvider",[J,ge,Pe]=we("Toast"),[ce,wt]=Te("Toast",[Pe]),[Re,H]=ce(ae),ie=t=>{const{__scopeToast:n,label:r="Notification",duration:o=5e3,swipeDirection:i="right",swipeThreshold:l=50,children:p}=t,[f,b]=e.useState(null),[a,x]=e.useState(0),v=e.useRef(!1),O=e.useRef(!1);return e.createElement(J.Provider,{scope:n},e.createElement(Re,{scope:n,label:r,duration:o,swipeDirection:i,swipeThreshold:l,toastCount:a,viewport:f,onViewportChange:b,onToastAdd:e.useCallback(()=>x(_=>_+1),[]),onToastRemove:e.useCallback(()=>x(_=>_-1),[]),isFocusedToastEscapeKeyDownRef:v,isClosePausedRef:O},p))};ie.propTypes={label(t){if(t.label&&typeof t.label=="string"&&!t.label.trim()){const n=`Invalid prop \`label\` supplied to \`${ae}\`. Expected non-empty \`string\`.`;return new Error(n)}return null}};const _e="ToastViewport",Se=["F8"],z="toast.viewportPause",G="toast.viewportResume",De=e.forwardRef((t,n)=>{const{__scopeToast:r,hotkey:o=Se,label:i="Notifications ({hotkey})",...l}=t,p=H(_e,r),f=ge(r),b=e.useRef(null),a=e.useRef(null),x=e.useRef(null),v=e.useRef(null),O=re(n,v,p.onViewportChange),_=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),S=p.toastCount>0;e.useEffect(()=>{const c=E=>{var u;o.every(m=>E[m]||E.code===m)&&((u=v.current)===null||u===void 0||u.focus())};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[o]),e.useEffect(()=>{const c=b.current,E=v.current;if(S&&c&&E){const u=()=>{if(!p.isClosePausedRef.current){const T=new CustomEvent(z);E.dispatchEvent(T),p.isClosePausedRef.current=!0}},$=()=>{if(p.isClosePausedRef.current){const T=new CustomEvent(G);E.dispatchEvent(T),p.isClosePausedRef.current=!1}},m=T=>{!c.contains(T.relatedTarget)&&$()},w=()=>{c.contains(document.activeElement)||$()};return c.addEventListener("focusin",u),c.addEventListener("focusout",m),c.addEventListener("pointermove",u),c.addEventListener("pointerleave",w),window.addEventListener("blur",u),window.addEventListener("focus",$),()=>{c.removeEventListener("focusin",u),c.removeEventListener("focusout",m),c.removeEventListener("pointermove",u),c.removeEventListener("pointerleave",w),window.removeEventListener("blur",u),window.removeEventListener("focus",$)}}},[S,p.isClosePausedRef]);const d=e.useCallback(({tabbingDirection:c})=>{const u=f().map($=>{const m=$.ref.current,w=[m,...Be(m)];return c==="forwards"?w:w.reverse()});return(c==="forwards"?u.reverse():u).flat()},[f]);return e.useEffect(()=>{const c=v.current;if(c){const E=u=>{const $=u.altKey||u.ctrlKey||u.metaKey;if(u.key==="Tab"&&!$){const L=document.activeElement,I=u.shiftKey;if(u.target===c&&I){var w;(w=a.current)===null||w===void 0||w.focus();return}const D=d({tabbingDirection:I?"backwards":"forwards"}),k=D.findIndex(s=>s===L);if(q(D.slice(k+1)))u.preventDefault();else{var T,P;I?(T=a.current)===null||T===void 0||T.focus():(P=x.current)===null||P===void 0||P.focus()}}};return c.addEventListener("keydown",E),()=>c.removeEventListener("keydown",E)}},[f,d]),e.createElement(ve,{ref:b,role:"region","aria-label":i.replace("{hotkey}",_),tabIndex:-1,style:{pointerEvents:S?void 0:"none"}},S&&e.createElement(Z,{ref:a,onFocusFromOutsideViewport:()=>{const c=d({tabbingDirection:"forwards"});q(c)}}),e.createElement(J.Slot,{scope:r},e.createElement(F.ol,g({tabIndex:-1},l,{ref:O}))),S&&e.createElement(Z,{ref:x,onFocusFromOutsideViewport:()=>{const c=d({tabbingDirection:"backwards"});q(c)}}))}),Ie="ToastFocusProxy",Z=e.forwardRef((t,n)=>{const{__scopeToast:r,onFocusFromOutsideViewport:o,...i}=t,l=H(Ie,r);return e.createElement(se,g({"aria-hidden":!0,tabIndex:0},i,{ref:n,style:{position:"fixed"},onFocus:p=>{var f;const b=p.relatedTarget;!((f=l.viewport)!==null&&f!==void 0&&f.contains(b))&&o()}}))}),X="Toast",Ae="toast.swipeStart",Fe="toast.swipeMove",Oe="toast.swipeCancel",Le="toast.swipeEnd",Me=e.forwardRef((t,n)=>{const{forceMount:r,open:o,defaultOpen:i,onOpenChange:l,...p}=t,[f=!0,b]=Ce({prop:o,defaultProp:i,onChange:l});return e.createElement(ye,{present:r||f},e.createElement(de,g({open:f},p,{ref:n,onClose:()=>b(!1),onPause:U(t.onPause),onResume:U(t.onResume),onSwipeStart:C(t.onSwipeStart,a=>{a.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:C(t.onSwipeMove,a=>{const{x,y:v}=a.detail.delta;a.currentTarget.setAttribute("data-swipe","move"),a.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${x}px`),a.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${v}px`)}),onSwipeCancel:C(t.onSwipeCancel,a=>{a.currentTarget.setAttribute("data-swipe","cancel"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),a.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),a.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:C(t.onSwipeEnd,a=>{const{x,y:v}=a.detail.delta;a.currentTarget.setAttribute("data-swipe","end"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),a.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),a.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${x}px`),a.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${v}px`),b(!1)})})))}),[Ne,ke]=ce(X,{onClose(){}}),de=e.forwardRef((t,n)=>{const{__scopeToast:r,type:o="foreground",duration:i,open:l,onClose:p,onEscapeKeyDown:f,onPause:b,onResume:a,onSwipeStart:x,onSwipeMove:v,onSwipeCancel:O,onSwipeEnd:_,...S}=t,d=H(X,r),[c,E]=e.useState(null),u=re(n,s=>E(s)),$=e.useRef(null),m=e.useRef(null),w=i||d.duration,T=e.useRef(0),P=e.useRef(w),L=e.useRef(0),{onToastAdd:I,onToastRemove:Y}=d,A=U(()=>{var s;(c==null?void 0:c.contains(document.activeElement))&&((s=d.viewport)===null||s===void 0||s.focus()),p()}),D=e.useCallback(s=>{!s||s===1/0||(window.clearTimeout(L.current),T.current=new Date().getTime(),L.current=window.setTimeout(A,s))},[A]);e.useEffect(()=>{const s=d.viewport;if(s){const y=()=>{D(P.current),a==null||a()},R=()=>{const M=new Date().getTime()-T.current;P.current=P.current-M,window.clearTimeout(L.current),b==null||b()};return s.addEventListener(z,R),s.addEventListener(G,y),()=>{s.removeEventListener(z,R),s.removeEventListener(G,y)}}},[d.viewport,w,b,a,D]),e.useEffect(()=>{l&&!d.isClosePausedRef.current&&D(w)},[l,w,d.isClosePausedRef,D]),e.useEffect(()=>(I(),()=>Y()),[I,Y]);const k=e.useMemo(()=>c?pe(c):null,[c]);return d.viewport?e.createElement(e.Fragment,null,k&&e.createElement(Ke,{__scopeToast:r,role:"status","aria-live":o==="foreground"?"assertive":"polite","aria-atomic":!0},k),e.createElement(Ne,{scope:r,onClose:A},me.createPortal(e.createElement(J.ItemSlot,{scope:r},e.createElement(Ee,{asChild:!0,onEscapeKeyDown:C(f,()=>{d.isFocusedToastEscapeKeyDownRef.current||A(),d.isFocusedToastEscapeKeyDownRef.current=!1})},e.createElement(F.li,g({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":d.swipeDirection},S,{ref:u,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:C(t.onKeyDown,s=>{s.key==="Escape"&&(f==null||f(s.nativeEvent),s.nativeEvent.defaultPrevented||(d.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:C(t.onPointerDown,s=>{s.button===0&&($.current={x:s.clientX,y:s.clientY})}),onPointerMove:C(t.onPointerMove,s=>{if(!$.current)return;const y=s.clientX-$.current.x,R=s.clientY-$.current.y,M=!!m.current,N=["left","right"].includes(d.swipeDirection),K=["left","up"].includes(d.swipeDirection)?Math.min:Math.max,fe=N?K(0,y):0,be=N?0:K(0,R),B=s.pointerType==="touch"?10:2,V={x:fe,y:be},Q={originalEvent:s,delta:V};M?(m.current=V,j(Fe,v,Q,{discrete:!1})):ee(V,d.swipeDirection,B)?(m.current=V,j(Ae,x,Q,{discrete:!1}),s.target.setPointerCapture(s.pointerId)):(Math.abs(y)>B||Math.abs(R)>B)&&($.current=null)}),onPointerUp:C(t.onPointerUp,s=>{const y=m.current,R=s.target;if(R.hasPointerCapture(s.pointerId)&&R.releasePointerCapture(s.pointerId),m.current=null,$.current=null,y){const M=s.currentTarget,N={originalEvent:s,delta:y};ee(y,d.swipeDirection,d.swipeThreshold)?j(Le,_,N,{discrete:!0}):j(Oe,O,N,{discrete:!0}),M.addEventListener("click",K=>K.preventDefault(),{once:!0})}})})))),d.viewport))):null});de.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){const n=`Invalid prop \`type\` supplied to \`${X}\`. Expected \`foreground | background\`.`;return new Error(n)}return null}};const Ke=t=>{const{__scopeToast:n,children:r,...o}=t,i=H(X,n),[l,p]=e.useState(!1),[f,b]=e.useState(!1);return Xe(()=>p(!0)),e.useEffect(()=>{const a=window.setTimeout(()=>b(!0),1e3);return()=>window.clearTimeout(a)},[]),f?null:e.createElement(xe,{asChild:!0},e.createElement(se,o,l&&e.createElement(e.Fragment,null,i.label," ",r)))},Ve=e.forwardRef((t,n)=>{const{__scopeToast:r,...o}=t;return e.createElement(F.div,g({},o,{ref:n}))}),je=e.forwardRef((t,n)=>{const{__scopeToast:r,...o}=t;return e.createElement(F.div,g({},o,{ref:n}))}),We="ToastAction",ue=e.forwardRef((t,n)=>{const{altText:r,...o}=t;return r?e.createElement(le,{altText:r,asChild:!0},e.createElement(He,g({},o,{ref:n}))):null});ue.propTypes={altText(t){return t.altText?null:new Error(`Missing prop \`altText\` expected on \`${We}\``)}};const Ue="ToastClose",He=e.forwardRef((t,n)=>{const{__scopeToast:r,...o}=t,i=ke(Ue,r);return e.createElement(le,{asChild:!0},e.createElement(F.button,g({type:"button"},o,{ref:n,onClick:C(t.onClick,i.onClose)})))}),le=e.forwardRef((t,n)=>{const{__scopeToast:r,altText:o,...i}=t;return e.createElement(F.div,g({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":o||void 0},i,{ref:n}))});function pe(t){const n=[];return Array.from(t.childNodes).forEach(o=>{if(o.nodeType===o.TEXT_NODE&&o.textContent&&n.push(o.textContent),Ye(o)){const i=o.ariaHidden||o.hidden||o.style.display==="none",l=o.dataset.radixToastAnnounceExclude==="";if(!i)if(l){const p=o.dataset.radixToastAnnounceAlt;p&&n.push(p)}else n.push(...pe(o))}}),n}function j(t,n,r,{discrete:o}){const i=r.originalEvent.currentTarget,l=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});n&&i.addEventListener(t,n,{once:!0}),o?$e(i,l):i.dispatchEvent(l)}const ee=(t,n,r=0)=>{const o=Math.abs(t.x),i=Math.abs(t.y),l=o>i;return n==="left"||n==="right"?l&&o>r:!l&&i>r};function Xe(t=()=>{}){const n=U(t);he(()=>{let r=0,o=0;return r=window.requestAnimationFrame(()=>o=window.requestAnimationFrame(n)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(o)}},[n])}function Ye(t){return t.nodeType===t.ELEMENT_NODE}function Be(t){const n=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const i=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||i?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)n.push(r.currentNode);return n}function q(t){const n=document.activeElement;return t.some(r=>r===n?!0:(r.focus(),document.activeElement!==n))}const qe=ie,ze=De,Ge=Me,Je=Ve,Qe=je,Ze=ue,et=()=>{const[t,n]=e.useState(!1),r=e.useRef(new Date),o=e.useRef(0);return e.useEffect(()=>()=>clearTimeout(o.current),[]),h.jsxs(qe,{swipeDirection:"right",children:[h.jsx("button",{className:"Button large violet",onClick:()=>{n(!1),window.clearTimeout(o.current),o.current=window.setTimeout(()=>{r.current=tt(),n(!0)},100)},children:"Add to calendar"}),h.jsxs(Ge,{open:t,onOpenChange:n,children:[h.jsx(Je,{children:"Scheduled: Catch up"}),h.jsx(Qe,{asChild:!0,children:h.jsx("time",{dateTime:r.current.toISOString(),children:ot(r.current)})}),h.jsx(Ze,{asChild:!0,altText:"Goto schedule to undo",children:h.jsx("button",{children:"Undo"})})]}),h.jsx(ze,{})]})};function tt(){const t=new Date,n=t.setDate(t.getDate()+7);return new Date(n)}function ot(t){return new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"short"}).format(t)}const Tt={title:"Radix UI/Toast",component:et},W={args:{}};var te,oe,ne;W.parameters={...W.parameters,docs:{...(te=W.parameters)==null?void 0:te.docs,source:{originalSource:`{
  args: {}
}`,...(ne=(oe=W.parameters)==null?void 0:oe.docs)==null?void 0:ne.source}}};const vt=["Default"];export{W as Default,vt as __namedExportsOrder,Tt as default};
//# sourceMappingURL=index.stories-384d1bcb.js.map
