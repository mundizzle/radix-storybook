import{a as G,$ as P,j as C}from"./index-b6d4726d.js";import{_ as F}from"./extends-98964cd2.js";import{r as t}from"./index-ad8e37b4.js";import{$ as V}from"./index-1b3f171e.js";import{$ as fe}from"./index-25542281.js";import{$ as H}from"./index-21bbdcc0.js";import{a as ve}from"./index-cd007cb5.js";import"./_commonjsHelpers-725317a4.js";import"./index-de5e260d.js";const[N,Ke]=fe("Form"),oe="Form",[$e,S]=N(oe),[he,ne]=N(oe),Ce=t.forwardRef((e,r)=>{const{__scopeForm:a,onClearServerErrors:i=()=>{},...c}=e,d=t.useRef(null),v=G(r,d),[m,$]=t.useState({}),f=t.useCallback(n=>m[n],[m]),y=t.useCallback((n,s)=>$(l=>{var u;return{...l,[n]:{...(u=l[n])!==null&&u!==void 0?u:{},...s}}}),[]),_=t.useCallback(n=>{$(s=>({...s,[n]:void 0})),o(s=>({...s,[n]:{}}))},[]),[p,E]=t.useState({}),x=t.useCallback(n=>{var s;return(s=p[n])!==null&&s!==void 0?s:[]},[p]),b=t.useCallback((n,s)=>{E(l=>{var u;return{...l,[n]:[...(u=l[n])!==null&&u!==void 0?u:[],s]}})},[]),g=t.useCallback((n,s)=>{E(l=>{var u;return{...l,[n]:((u=l[n])!==null&&u!==void 0?u:[]).filter(k=>k.id!==s)}})},[]),[I,o]=t.useState({}),h=t.useCallback(n=>{var s;return(s=I[n])!==null&&s!==void 0?s:{}},[I]),M=t.useCallback((n,s)=>{o(l=>{var u;return{...l,[n]:{...(u=l[n])!==null&&u!==void 0?u:{},...s}}})},[]),[R,A]=t.useState({}),O=t.useCallback((n,s)=>{A(l=>{const u=new Set(l[n]).add(s);return{...l,[n]:u}})},[]),D=t.useCallback((n,s)=>{A(l=>{const u=new Set(l[n]);return u.delete(s),{...l,[n]:u}})},[]),T=t.useCallback(n=>{var s;return Array.from((s=R[n])!==null&&s!==void 0?s:[]).join(" ")||void 0},[R]);return t.createElement($e,{scope:a,getFieldValidity:f,onFieldValidityChange:y,getFieldCustomMatcherEntries:x,onFieldCustomMatcherEntryAdd:b,onFieldCustomMatcherEntryRemove:g,getFieldCustomErrors:h,onFieldCustomErrorsChange:M,onFieldValiditionClear:_},t.createElement(he,{scope:a,onFieldMessageIdAdd:O,onFieldMessageIdRemove:D,getFieldDescription:T},t.createElement(P.form,F({},c,{ref:v,onInvalid:V(e.onInvalid,n=>{const s=se(n.currentTarget);s===n.target&&s.focus(),n.preventDefault()}),onSubmit:V(e.onSubmit,i,{checkForDefaultPrevented:!1}),onReset:V(e.onReset,i)}))))}),ae="FormField",[pe,K]=N(ae),Fe=t.forwardRef((e,r)=>{const{__scopeForm:a,name:i,serverInvalid:c=!1,...d}=e,m=S(ae,a).getFieldValidity(i),$=H();return t.createElement(pe,{scope:a,id:$,name:i,serverInvalid:c},t.createElement(P.div,F({"data-valid":z(m,c),"data-invalid":J(m,c)},d,{ref:r})))}),W="FormLabel",Ee=t.forwardRef((e,r)=>{const{__scopeForm:a,...i}=e,c=S(W,a),d=K(W,a),v=i.htmlFor||d.id,m=c.getFieldValidity(d.name);return t.createElement(ve,F({"data-valid":z(m,d.serverInvalid),"data-invalid":J(m,d.serverInvalid)},i,{ref:r,htmlFor:v}))}),q="FormControl",ge=t.forwardRef((e,r)=>{const{__scopeForm:a,...i}=e,c=S(q,a),d=K(q,a),v=ne(q,a),m=t.useRef(null),$=G(r,m),f=i.name||d.name,y=i.id||d.id,_=c.getFieldCustomMatcherEntries(f),{onFieldValidityChange:p,onFieldCustomErrorsChange:E,onFieldValiditionClear:x}=c,b=t.useCallback(async o=>{if(ie(o.validity)){const l=B(o.validity);p(f,l);return}const h=o.form?new FormData(o.form):new FormData,M=[o.value,h],R=[],A=[];_.forEach(l=>{Ve(l,M)?A.push(l):je(l)&&R.push(l)});const O=R.map(({id:l,match:u})=>[l,u(...M)]),D=Object.fromEntries(O),T=Object.values(D).some(Boolean),n=T;o.setCustomValidity(n?j:"");const s=B(o.validity);if(p(f,s),E(f,D),!T&&A.length>0){const l=A.map(({id:le,match:ue})=>ue(...M).then(me=>[le,me])),u=await Promise.all(l),k=Object.fromEntries(u),ce=Object.values(k).some(Boolean);o.setCustomValidity(ce?j:"");const de=B(o.validity);p(f,de),E(f,k)}},[_,f,E,p]);t.useEffect(()=>{const o=m.current;if(o){const h=()=>b(o);return o.addEventListener("change",h),()=>o.removeEventListener("change",h)}},[b]);const g=t.useCallback(()=>{const o=m.current;o&&(o.setCustomValidity(""),x(f))},[f,x]);t.useEffect(()=>{var o;const h=(o=m.current)===null||o===void 0?void 0:o.form;if(h)return h.addEventListener("reset",g),()=>h.removeEventListener("reset",g)},[g]),t.useEffect(()=>{const o=m.current,h=o==null?void 0:o.closest("form");if(h&&d.serverInvalid){const M=se(h);M===o&&M.focus()}},[d.serverInvalid]);const I=c.getFieldValidity(f);return t.createElement(P.input,F({"data-valid":z(I,d.serverInvalid),"data-invalid":J(I,d.serverInvalid),"aria-invalid":d.serverInvalid?!0:void 0,"aria-describedby":v.getFieldDescription(f),title:""},i,{ref:$,id:y,name:f,onInvalid:V(e.onInvalid,o=>{const h=o.currentTarget;b(h)}),onChange:V(e.onChange,o=>{g()})}))}),j="This value is not valid",ye={badInput:j,patternMismatch:"This value does not match the required pattern",rangeOverflow:"This value is too large",rangeUnderflow:"This value is too small",stepMismatch:"This value does not match the required step",tooLong:"This value is too long",tooShort:"This value is too short",typeMismatch:"This value does not match the required type",valid:void 0,valueMissing:"This value is missing"},w="FormMessage",be=t.forwardRef((e,r)=>{const{match:a,name:i,...c}=e,d=K(w,e.__scopeForm),v=i??d.name;return a===void 0?t.createElement(Q,F({},c,{ref:r,name:v}),e.children||j):typeof a=="function"?t.createElement(xe,F({match:a},c,{ref:r,name:v})):t.createElement(Me,F({match:a},c,{ref:r,name:v}))}),Me=t.forwardRef((e,r)=>{const{match:a,forceMatch:i=!1,name:c,children:d,...v}=e,$=S(w,v.__scopeForm).getFieldValidity(c);return i||($==null?void 0:$[a])?t.createElement(Q,F({ref:r},v,{name:c}),d??ye[a]):null}),xe=t.forwardRef((e,r)=>{const{match:a,forceMatch:i=!1,name:c,id:d,children:v,...m}=e,$=S(w,m.__scopeForm),f=t.useRef(null),y=G(r,f),_=H(),p=d??_,E=t.useMemo(()=>({id:p,match:a}),[p,a]),{onFieldCustomMatcherEntryAdd:x,onFieldCustomMatcherEntryRemove:b}=$;t.useEffect(()=>(x(c,E),()=>b(c,E.id)),[E,c,x,b]);const g=$.getFieldValidity(c),o=$.getFieldCustomErrors(c)[p];return i||g&&!ie(g)&&o?t.createElement(Q,F({id:p,ref:y},m,{name:c}),v??j):null}),Q=t.forwardRef((e,r)=>{const{__scopeForm:a,id:i,name:c,...d}=e,v=ne(w,a),m=H(),$=i??m,{onFieldMessageIdAdd:f,onFieldMessageIdRemove:y}=v;return t.useEffect(()=>(f(c,$),()=>y(c,$)),[c,$,f,y]),t.createElement(P.span,F({id:$},d,{ref:r}))}),_e=t.forwardRef((e,r)=>{const{__scopeForm:a,...i}=e;return t.createElement(P.button,F({type:"submit"},i,{ref:r}))});function B(e){const r={};for(const a in e)r[a]=e[a];return r}function Ie(e){return e instanceof HTMLElement}function Ae(e){return"validity"in e}function Re(e){return Ae(e)&&(e.validity.valid===!1||e.getAttribute("aria-invalid")==="true")}function se(e){const r=e.elements,[a]=Array.from(r).filter(Ie).filter(Re);return a}function Ve(e,r){return e.match.constructor.name==="AsyncFunction"||Pe(e.match,r)}function je(e){return e.match.constructor.name==="Function"}function Pe(e,r){return e(...r)instanceof Promise}function ie(e){let r=!1;for(const a in e){const i=a;if(i!=="valid"&&i!=="customError"&&e[i]){r=!0;break}}return r}function z(e,r){if((e==null?void 0:e.valid)===!0&&!r)return!0}function J(e,r){if((e==null?void 0:e.valid)===!1||r)return!0}const Se=Ce,X=Fe,Y=Ee,Z=ge,U=be,De=_e,Te=()=>C.jsxs(Se,{children:[C.jsxs(X,{name:"email",children:[C.jsx(Y,{children:"Email"}),C.jsx(U,{match:"valueMissing",children:"Please enter your email"}),C.jsx(U,{match:"typeMismatch",children:"Please provide a valid email"}),C.jsx(Z,{asChild:!0,children:C.jsx("input",{type:"email",required:!0})})]}),C.jsxs(X,{name:"question",children:[C.jsx(Y,{children:"Question"}),C.jsx(U,{match:"valueMissing",children:"Please enter a question"}),C.jsx(Z,{asChild:!0,children:C.jsx("textarea",{required:!0})})]}),C.jsx(De,{asChild:!0,children:C.jsx("button",{children:"Post question"})})]}),Qe={title:"Radix UI/Form",component:Te},L={args:{}};var ee,te,re;L.parameters={...L.parameters,docs:{...(ee=L.parameters)==null?void 0:ee.docs,source:{originalSource:`{
  args: {}
}`,...(re=(te=L.parameters)==null?void 0:te.docs)==null?void 0:re.source}}};const ze=["Default"];export{L as Default,ze as __namedExportsOrder,Qe as default};
//# sourceMappingURL=index.stories-eb0f0046.js.map
